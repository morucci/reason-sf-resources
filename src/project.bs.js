// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Json = require("@glennsl/bs-json/src/Json.bs.js");
var Caml_array = require("bs-platform/lib/js/caml_array.js");
var Json_decode = require("@glennsl/bs-json/src/Json_decode.bs.js");

var example = "\n{\n  \"contacts\": [\n    \"harrymichal@seznam.cz\"\n  ],\n  \"description\": \"Unprivileged development environment\",\n  \"tenant\": \"local\",\n  \"website\": \"https://github.com/debarshiray/toolbox\",\n  \"name\": \"toolbox\",\n  \"source-repositories\": [\n    {\n      \"containers/toolbox\": {\n        \"connection\": \"github.com\",\n        \"zuul/exclude-unprotected-branches\": true\n      }\n    }\n  ]\n}\n";

function connection(param) {
  return Json_decode.field("connection", Json_decode.string, param);
}

function obj(param) {
  return Json_decode.dict(connection, param);
}

var SRDecode = {
  connection: connection,
  obj: obj
};

function parseSourceRepositories(json) {
  var srdict = Json_decode.dict(connection, json);
  var srdictKey0 = Caml_array.caml_array_get(Object.keys(srdict), 0);
  var connection$1 = Json_decode.optional(Json_decode.at({
            hd: srdictKey0,
            tl: /* [] */0
          }, connection), json);
  return {
          name: srdictKey0,
          connection: connection$1
        };
}

function parseProject(json) {
  var data = Json.parseOrRaise(json);
  return {
          name: Json_decode.optional((function (param) {
                  return Json_decode.field("name", Json_decode.string, param);
                }), data),
          description: Json_decode.field("description", Json_decode.string, data),
          tenant: Json_decode.optional((function (param) {
                  return Json_decode.field("tenant", Json_decode.string, param);
                }), data),
          connection: Json_decode.optional((function (param) {
                  return Json_decode.field("connection", Json_decode.string, param);
                }), data),
          website: Json_decode.optional((function (param) {
                  return Json_decode.field("website", Json_decode.string, param);
                }), data),
          documentation: Json_decode.optional((function (param) {
                  return Json_decode.field("documentation", Json_decode.string, param);
                }), data),
          issue_tracker_url: Json_decode.optional((function (param) {
                  return Json_decode.field("issue-tracker-url", Json_decode.string, param);
                }), data),
          review_dashboard: Json_decode.optional((function (param) {
                  return Json_decode.field("review-dashboard", Json_decode.string, param);
                }), data),
          mailing_lists: Json_decode.optional((function (param) {
                  return Json_decode.field("mailing-lists", (function (param) {
                                return Json_decode.list(Json_decode.string, param);
                              }), param);
                }), data),
          contacts: Json_decode.optional((function (param) {
                  return Json_decode.field("contacts", (function (param) {
                                return Json_decode.list(Json_decode.string, param);
                              }), param);
                }), data),
          source_repositories: Json_decode.field("source-repositories", (function (param) {
                  return Json_decode.list(parseSourceRepositories, param);
                }), data),
          options: Json_decode.optional((function (param) {
                  return Json_decode.field("options", (function (param) {
                                return Json_decode.list(Json_decode.string, param);
                              }), param);
                }), data)
        };
}

function runExample(param) {
  return parseProject(example);
}

exports.example = example;
exports.SRDecode = SRDecode;
exports.parseSourceRepositories = parseSourceRepositories;
exports.parseProject = parseProject;
exports.runExample = runExample;
/* No side effect */
